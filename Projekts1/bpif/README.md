# MOEX Bonds Filler

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–± –æ–±–ª–∏–≥–∞—Ü–∏—è—Ö –∏–∑ MOEX ISS API.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –Ω–∞ Python –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã Excel –¥–∞–Ω–Ω—ã–º–∏ –æ–± –æ–±–ª–∏–≥–∞—Ü–∏—è—Ö, —Ç–æ—Ä–≥—É–µ–º—ã—Ö –Ω–∞ –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –±–∏—Ä–∂–µ (MOEX).

### –ó–∞–ø–æ–ª–Ω—è–µ–º—ã–µ –ø–æ–ª—è:
- **–≠–º–∏—Ç–µ–Ω—Ç** ‚Äî –∏–º—è —ç–º–∏—Ç–µ–Ω—Ç–∞ –æ–±–ª–∏–≥–∞—Ü–∏–∏
- **YTM, %** ‚Äî –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∫ –æ—Ñ—Ñ–µ—Ä–µ/–ø–æ–≥–∞—à–µ–Ω–∏—é
- **–ö—É–ø–æ–Ω–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å** ‚Äî –≥–æ–¥–æ–≤–∞—è –∫—É–ø–æ–Ω–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
- **–ö—É–ø–æ–Ω** ‚Äî —Ä–∞–∑–º–µ—Ä –∫—É–ø–æ–Ω–∞ –≤ –µ–¥–∏–Ω–∏—Ü–∞—Ö –≤–∞–ª—é—Ç—ã
- **–í–æ–ª—é—Ç–∞** ‚Äî –≤–∞–ª—é—Ç–∞ –∞–∫—Ç–∏–≤–∞
- **–ß–∞—Å—Ç–æ—Ç–∞ –∫—É–ø–æ–Ω–∞** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–ª–∞—Ç –≤ –≥–æ–¥ (2, 4, 12)
- **–î–∞—Ç–∞ –ø–æ–≥–∞—à–µ–Ω–∏—è** ‚Äî –¥–∞—Ç–∞ –ø–æ–≥–∞—à–µ–Ω–∏—è –æ–±–ª–∏–≥–∞—Ü–∏–∏
- **–î–∞—Ç–∞ –æ—Ñ–µ—Ä—Ç—ã** ‚Äî –¥–∞—Ç–∞ –±–ª–∏–∂–∞–π—à–µ–π –æ—Ñ—Ñ–µ—Ä–µ

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.7+
- –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ —Ñ–∞–π–ª `BPIF.xlsx` —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
   - `Shortname` ‚Äî –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è –æ–±–ª–∏–≥–∞—Ü–∏–∏
   - `ISIN` ‚Äî ISIN –∫–æ–¥ –æ–±–ª–∏–≥–∞—Ü–∏–∏
   - –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –ø—É—Å—Ç—ã (–±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã)

2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø—É—Ç–∏ –≤ —Å–∫—Ä–∏–ø—Ç–µ (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ):
   ```python
   INPUT_FILE = Path(r"C:\–ø—É—Ç—å\–∫\BPIF.xlsx")
   OUTPUT_FILE = Path(r"C:\–ø—É—Ç—å\–∫\BPIF_filled.xlsx")
   ```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
   ```bash
   python fill_bonds_v5_final.py
   ```

4. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `BPIF_filled.xlsx`

## üìä –ü—Ä–∏–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

| Shortname | ISIN | –≠–º–∏—Ç–µ–Ω—Ç | YTM, % | –ö—É–ø–æ–Ω–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å | –ö—É–ø–æ–Ω | –í–æ–ª—é—Ç–∞ | –ß–∞—Å—Ç–æ—Ç–∞ –∫—É–ø–æ–Ω–∞ | –î–∞—Ç–∞ –ø–æ–≥–∞—à–µ–Ω–∏—è | –î–∞—Ç–∞ –æ—Ñ–µ—Ä—Ç—ã |
|-----------|------|---------|--------|-------------------|-------|--------|----------------|----------------|-------------|
| –ú—ç–π–ª.–†—É –§–∏–Ω–∞–Ω—Å 001P-01 | RU000A103QK3 | | | | | | | | |
| –ü–æ–ª–∏–ø–ª–∞—Å—Ç –æ–±–±2–ü06 | RU000A10BU07 | | | | | | | | |

## üìä –ü—Ä–∏–º–µ—Ä –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

| Shortname | ISIN | –≠–º–∏—Ç–µ–Ω—Ç | YTM, % | –ö—É–ø–æ–Ω–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å | –ö—É–ø–æ–Ω | –í–æ–ª—é—Ç–∞ | –ß–∞—Å—Ç–æ—Ç–∞ –∫—É–ø–æ–Ω–∞ | –î–∞—Ç–∞ –ø–æ–≥–∞—à–µ–Ω–∏—è | –î–∞—Ç–∞ –æ—Ñ–µ—Ä—Ç—ã | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
|-----------|------|---------|--------|-------------------|-------|--------|----------------|----------------|-------------|-------------|
| –ú—ç–π–ª.–†—É –§–∏–Ω–∞–Ω—Å 001P-01 | RU000A103QK3 | –û–±—â–µ—Å—Ç–≤–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é "–ú—ç–π–ª.–†—É –§–∏–Ω–∞–Ω—Å" | 17.54 | 7.9 | 39.39 | SUR | 2 | 15.09.2026 | | OK |
| –ü–æ–ª–∏–ø–ª–∞—Å—Ç –æ–±–±2–ü06 | RU000A10BU07 | –û–û–û "–ü–æ–ª–∏–ø–ª–∞—Å—Ç" | 12.95 | 12.95 | 1.06 | USD | 12 | 07.12.2027 | | OK |

## üîå API –ò—Å—Ç–æ—á–Ω–∏–∫

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–π –ø—É–±–ª–∏—á–Ω—ã–π API –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –±–∏—Ä–∂–∏:
- **Base URL:** https://iss.moex.com/iss
- **Endpoint 1:** `/securities.json` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —ç–º–∏—Ç–µ–Ω—Ç–µ
- **Endpoint 2:** `/engines/stock/markets/bonds/securities/{ISIN}.json` ‚Äî –¥–µ—Ç–∞–ª–∏ –æ–±–ª–∏–≥–∞—Ü–∏–∏

## ‚è±Ô∏è –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- ~0.5 —Å–µ–∫ –Ω–∞ –æ–¥–Ω—É –æ–±–ª–∏–≥–∞—Ü–∏—é (–≤–∫–ª—é—á–∞—è –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏)
- –î–ª—è 136 –æ–±–ª–∏–≥–∞—Ü–∏–π: ~68 —Å–µ–∫—É–Ω–¥

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–ª–æ–Ω–∫—É "–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ" —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏:
- `OK` ‚Äî —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞
- `no_data` ‚Äî –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ API
- `ISIN –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç` ‚Äî –Ω–µ—Ç ISIN –≤ —Å—Ç—Ä–æ–∫–µ
- –û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ ‚Äî –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Python 3.7+**
- **pandas** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å Excel
- **requests** ‚Äî HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ API
- **openpyxl** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ Excel —Ñ–∞–π–ª–æ–≤

## üìÑ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è (requirements.txt)

```
pandas>=1.3.0
requests>=2.26.0
openpyxl>=3.6.0
```

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏. –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –¥—Ä—É–≥—É—é –ø–∞–ø–∫—É, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `INPUT_FILE` –∏ `OUTPUT_FILE`
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –¥–µ–ª–∞—é—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 0.5 —Å–µ–∫ –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è –ª–∏–º–∏—Ç–æ–≤ API
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –æ–±–ª–∏–≥–∞—Ü–∏–∏, —Ç–æ—Ä–≥—É–µ–º—ã–µ –Ω–∞ MOEX (RUB, USD –∏ —Ç.–¥.)

## ü§ù –í–∫–ª–∞–¥

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏—è –∏–ª–∏ –Ω–∞—à–ª–∏ –±–∞–≥ ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ Issue –∏–ª–∏ Pull Request!

## üìß –ê–≤—Ç–æ—Ä

–°–æ–∑–¥–∞–Ω–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏–∑–∞ –æ–±–ª–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è.

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ!
